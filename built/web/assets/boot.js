"use strict";{const e=new URL(location.href);let t="localhost"==e.host?"misskey":e.host.split(".")[0],a=navigator.language.split("-")[0];/^(en|ja)$/.test(a)||(a="en"),localStorage.getItem("lang")&&(a=localStorage.getItem("lang"));const s=navigator.userAgent.toLowerCase(),o=/mobile|iphone|ipad|android/.test(s),i=document.getElementsByTagName("head")[0];if(o){const e=document.createElement("meta");e.setAttribute("name","viewport"),e.setAttribute("content","width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"),i.appendChild(e)}"misskey"==t&&(t=o?"mobile":"desktop");const n=localStorage.getItem("v")||"0.0.3999",r=document.createElement("script");r.setAttribute("src",`/assets/${t}.${n}.${a}.js`),r.setAttribute("async","true"),r.setAttribute("defer","true"),i.appendChild(r),window.mkBootTimer=window.setTimeout(async()=>{const e=await fetch("https://api.misskey.xyz/meta",{method:"POST",cache:"no-cache"});if((await e.json()).version!=n){alert("Misskeyの新しいバージョンがあります。ページを再度読み込みします。\n\nNew version of Misskey available. The page will be reloaded.");try{navigator.serviceWorker.controller.postMessage("clear"),navigator.serviceWorker.getRegistrations().then(e=>{e.forEach(e=>e.unregister())})}catch(e){console.error(e)}location.reload(!0)}},1e3)}